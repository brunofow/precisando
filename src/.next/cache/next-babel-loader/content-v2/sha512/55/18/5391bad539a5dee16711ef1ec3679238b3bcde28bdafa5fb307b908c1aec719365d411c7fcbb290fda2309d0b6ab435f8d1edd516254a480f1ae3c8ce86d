{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/bruno/Dev/Workspace/Personal/precisando/src/components/ImageInput/index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { useRef, useEffect, useCallback, useState } from 'react';\nimport { useField } from '@unform/core';\nimport styles from '../../styles/Components/ImageInput.module.css';\n\nconst ImageInput = (_ref) => {\n  let {\n    name,\n    placeholder\n  } = _ref,\n      rest = _objectWithoutProperties(_ref, [\"name\", \"placeholder\"]);\n\n  const inputRef = useRef(null);\n  const {\n    fieldName,\n    registerField,\n    defaultValue,\n    error\n  } = useField(name);\n  const {\n    0: preview,\n    1: setPreview\n  } = useState(defaultValue);\n  const {\n    0: updatedFile,\n    1: setUpdatedFile\n  } = useState('');\n  const handlePreview = useCallback(e => {\n    var _e$target$files;\n\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n\n    if (file) {\n      setPreview(null);\n    }\n\n    const validTypes = ['png', 'PNG', 'jpg', 'JPG', 'jpeg', 'JPEG'];\n    const valid = validTypes.filter(e => {\n      if (file !== null && file !== void 0 && file.name.includes(e)) {\n        return e;\n      }\n    });\n\n    if (!(file !== null && file !== void 0 && file.name.includes(valid[0]))) {\n      setPreview(null);\n      setUpdatedFile('');\n      alert('Por favor insira a imagem no formato, .png ou .jpg');\n      return;\n    }\n\n    const previewURL = URL.createObjectURL(file);\n    setUpdatedFile(file.name);\n    setPreview(previewURL);\n  }, []);\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      ref: inputRef.current,\n      path: 'files[0]',\n\n      clearValue(ref) {\n        ref.value = '';\n        setPreview(null);\n      },\n\n      setValue(_, value) {\n        setPreview(value);\n      }\n\n    });\n  }, [fieldName, registerField]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.preview,\n      children: preview && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: preview,\n        alt: \"Preview\",\n        width: \"100\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 51\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.inputBox,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", _objectSpread({\n        id: name,\n        type: \"file\",\n        ref: inputRef,\n        onChange: handlePreview,\n        accept: \"image/x-png,image/gif,image/jpeg\"\n      }, rest), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: name,\n        children: updatedFile ? updatedFile : placeholder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\nexport default ImageInput;","map":{"version":3,"sources":["/home/bruno/Dev/Workspace/Personal/precisando/src/components/ImageInput/index.tsx"],"names":["useRef","useEffect","useCallback","useState","useField","styles","ImageInput","name","placeholder","rest","inputRef","fieldName","registerField","defaultValue","error","preview","setPreview","updatedFile","setUpdatedFile","handlePreview","e","file","target","files","validTypes","valid","filter","includes","alert","previewURL","URL","createObjectURL","ref","current","path","clearValue","value","setValue","_","inputBox"],"mappings":"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","sourcesContent":["import { ChangeEvent, useRef, useEffect, useCallback, useState } from 'react';\nimport { useField } from '@unform/core';\n\nimport styles from '../../styles/Components/ImageInput.module.css';\n\ntype Props = {\n  name: string;\n  placeholder: string\n}\n\ntype InputProps = JSX.IntrinsicElements['input'] & Props;\n\nconst ImageInput: React.FC<InputProps> = ({name, placeholder, ...rest}) => {\n  \n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const { fieldName, registerField, defaultValue, error } = useField(name);\n  const [ preview, setPreview ] = useState(defaultValue);\n  const [updatedFile, setUpdatedFile ] = useState('');\n\n  const handlePreview = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n\n    if(file) {\n      setPreview(null)\n    }\n\n    const validTypes = ['png', 'PNG', 'jpg', 'JPG', 'jpeg', 'JPEG'];\n\n    const valid = validTypes.filter(e => {\n      if(file?.name.includes(e)){\n        return e;\n      }\n    })\n\n    if(!file?.name.includes(valid[0])) {\n      setPreview(null);\n      setUpdatedFile('');\n      alert('Por favor insira a imagem no formato, .png ou .jpg')\n      return;\n    }\n\n    const previewURL = URL.createObjectURL(file);\n    setUpdatedFile(file.name);\n\n    setPreview(previewURL);\n  }, [])\n\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      ref: inputRef.current,\n      path: 'files[0]',\n      clearValue(ref: HTMLInputElement) {\n        ref.value = '';\n        setPreview(null);\n      },\n      setValue(_: HTMLInputElement, value: string) {\n        setPreview(value);\n      }\n    })\n  }, [fieldName, registerField])\n\n  return (\n    <>\n      <div className={styles.preview}>{preview && <img src={preview} alt=\"Preview\" width=\"100\" />}</div>\n      <div className={styles.inputBox}>\n        <input id={name} type=\"file\" ref={inputRef} onChange={handlePreview} accept=\"image/x-png,image/gif,image/jpeg\" {...rest} />\n        <label htmlFor={name}>{updatedFile ? updatedFile : placeholder}</label>\n      </div>\n      \n    </>\n  )\n}\n\nexport default ImageInput;"]},"metadata":{},"sourceType":"module"}